<div dir="rtl">
  
# راه اندازی و کانفیگ logstash
  
  
  از ایجنت logstash برای دریافت لاگ کانتینر های داکر با کمک گرفتن از 
  یکی از لاگ درایور های داکر به نام `gelf` استفاده خواهیم کرد.
  دیزاین و آرشیتکت کلی logstash با استفاده از نمودار زیر شرح داده میشود.
    ![logstash diagram](https://user-images.githubusercontent.com/77579794/133299933-e75b31ee-73c7-4064-a395-322d834aaf80.png)
  
  1. کانتینر هدف میتواند داخل یا خارج از نتورک داکری باشد که کانتینر logstash  حضور دارد واین مورد اصلا مهم نیست و تمامی لاگ های ارسالی 
  توسط gelf 
  ابتدا به هاست اصلی بر روی پورت 12201 فرستاده میشود و سپس توسط docker-proxy به پورت 12201 کانتینر لاگ استش میرسد.
  
  2. در نتیجه از مورد قبلی همچنین میتواند لاگ کانتینر هایی که در هاستی خارج از هاست agent  ما حضور دارند نیز ارسال کرد.
  این کانفیگ مربوط به کانفیگ `gelf output` میباشد که در ادامه در موردش توضیح داده خواهد شد.
  
  3. در نهایت لاگ های جمع آوری شده در کانتینر لاگ استش پراسس میشوند و در این مرحله برای `elasticsearch output` ارسال خواهند شد.
  
  
  
  
  
  </div>
